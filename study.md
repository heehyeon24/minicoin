# MiniCoin 블록체인 학습 정리

## 1. 모든 노드가 전체 블록을 갖고 있나요?
- 퍼블릭 블록체인의 **풀노드**는 생성된 모든 블록과 트랜잭션을 저장·검증하며 서로 동기화합니다.
- 자원 절약을 위해 일부만 저장하거나 헤더만 유지하는 **라이트노드/프루노드**도 존재합니다. 이들은 풀노드에 의존해 필요한 데이터를 확인합니다.
- MiniCoin 예제는 인메모리 체인을 가진 단일 인스턴스로, 추후 노드 간 동기화를 구현하면 각 인스턴스가 동일한 체인 전체를 공유하도록 확장할 수 있습니다.

## 2. 블록 개수(Block Count)의 의미
- 블록 개수는 블록체인의 **길이** 또는 **블록 높이(height)**를 나타냅니다.
- 제네시스 블록(높이 0) 이후 블록이 추가될 때마다 높이가 1씩 증가합니다.
- 이 숫자는 네트워크가 얼마나 많은 거래 기록을 쌓았는지, 체인이 얼마나 오래 유지되어왔는지의 지표가 됩니다.

## 3. 블록이 늘어나는 기준
- 새 트랜잭션이 모여 후보 블록이 만들어집니다.
- Proof-of-Work 같은 합의 절차를 통과해야 하며, 보통 계산이 까다로운 해시 문제를 해결해야 합니다.
- 유효한 블록을 찾으면 네트워크에 전파되고, 다수가 승인하면 체인 끝에 연결되어 블록 수가 1 증가합니다.
- MiniCoin 현재 버전은 샘플 블록만 제공하지만, PoW와 동기화를 구현하면 이 과정을 실습할 수 있습니다.

## 4. 정해진 난이도를 만족하는 해시란?
- Proof-of-Work에서는 블록 헤더 해시가 네트워크가 정한 **난이도 조건**을 만족해야 합니다.
- 비트코인에서는 “해시 값이 특정 타겟 값보다 작을 것”이라는 규칙이며, 쉽게 표현하면 해시 앞자리 0이 일정 개수 이상 나와야 합니다.
- 이를 위해 채굴자는 `nonce` 값을 바꿔가며 해시를 반복 계산하고, 조건을 충족하는 해시를 찾으면 블록이 유효하다고 인정됩니다.
- 조건 확인은 빠르지만, 조건을 만족하는 해시를 찾는 과정은 계산적으로 어려워 네트워크 보안에 기여합니다.

## 5. 추가로 알아두면 좋은 개념
- **블록 헤더 구성**: 보통 이전 블록 해시, 머클 루트(트랜잭션 요약), 타임스탬프, 난이도 목표, nonce 등으로 구성됩니다. 해시 계산은 이 헤더 값들을 활용합니다.
- **머클 트리**: 블록 내부 트랜잭션을 효율적으로 요약하기 위해 사용하는 해시 트리 구조입니다. 트랜잭션 변조 여부를 빠르게 검증할 수 있어 라이트노드가 데이터 무결성을 확인할 때 유용합니다.
- **난이도 조절(Difficulty Adjustment)**: 네트워크는 일정 시간마다 실제 블록 생성 속도를 측정해 목표 시간(예: 10분)을 유지하도록 난이도 타겟을 조정합니다.
- **노드 역할 구분**: 풀노드 외에도 채굴 전용 노드(채굴 소프트웨어 + 마이너), 단순 지갑 노드(SPV, 라이트 노드) 등 목적에 따라 구현 세부가 달라집니다.
- **체인 분기와 합의**: 두 노드가 동시에 블록을 채굴하면 잠시 체인이 갈라질 수 있습니다. 가장 긴(또는 누적 난이도가 높은) 체인을 따르는 규칙이 있어 결국 하나로 합쳐집니다.

## 6. 블록 생성 흐름 (Mermaid 다이어그램)

```mermaid
flowchart LR
    subgraph Chain["확정된 블록체인 (수정 불가)"]
        B0["Block 0 (Genesis)"]
        B1["Block 1"]
        B2["Block 2"]
    end

    TX["새로운 거래 발생"]
    MEMPOOL["메모풀(후보 트랜잭션 모음)"]
    CANDIDATE["후보 블록 구성"]
    POW["Proof-of-Work\n난이도 충족 해시 탐색"]
    NEWBLOCK["새 블록 생성"]

    B0 --> B1 --> B2
    TX --> MEMPOOL --> CANDIDATE --> POW --> NEWBLOCK --> Chain

    note right of Chain
        기존 블록들은 확정 상태로,
        이후 수정하거나 트랜잭션을
        더 추가할 수 없다.
    end note

    note bottom of POW
        nonce를 바꿔가며 목표 난이도를
        만족하는 해시를 찾는다.
    end note
```

- 확정된 체인(`Chain`)은 과거 블록이 서로 해시로 연결되어 변경이 매우 어렵습니다.
- 새 거래는 메모풀에 쌓이고, 마이너가 후보 블록을 만들어 PoW를 통과하면 `NEWBLOCK`이 체인의 끝에 붙습니다.
